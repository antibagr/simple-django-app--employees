[flake8]
max-complexity = 6
max-line-length = 120
ignore =
    # Bugbear does not like ` = Depends(some)` call in default:
    B008,
    # conflicting rules
    W503, W504,
    # black prefers another formattings
    E203

# per-file-ignores =
#     # disable for `id` class attribute in model definition "is a python builtin, consider renaming the class attribute"
#     ./src/repository/db/models/*.py: A003
#     ./contrib/seed_db.py: E501
exclude =
    # ignore auto-generated migrations
    ./migrations/*,
    ./.cache/*,
    ./.mypy_cache/*,
    ./.venv/*

    # default
    .git,__pycache__,.tox,.DS_Store

[mypy]
plugins = pydantic.mypy, sqlmypy, loguru_mypy
disallow_subclassing_any = True
disallow_untyped_calls = True
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
no_implicit_optional = True
local_partial_types = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_unused_configs = True
warn_return_any = True
follow_imports_for_stubs = True
namespace_packages = True
show_error_codes = True
exclude = (src/cmd.py|migrations)


[tool:pytest]
asyncio_mode = auto
testpaths =
  tests
python_files = test_*.py

xfail_strict = true

addopts =
  --strict-markers
  --strict
  -s
  -p no:warnings
  -vvv

timeout = 10

[tool:isort]
profile = black

[mypy-json_logging]
ignore_missing_imports = True

[mypy-uvicorn.*]
ignore_missing_imports = True

[mypy-asyncpg.*]
ignore_missing_imports = True

[mypy-aiochclient.*]
ignore_missing_imports = True

[mypy-binance.*]
ignore_missing_imports = True


# игнорим только no-untyped-def и no-untyped-call
[mypy-tests.*]
disallow_untyped_calls = False
disallow_untyped_defs = False
disallow_incomplete_defs = False
